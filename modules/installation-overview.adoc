// Module included in the following assemblies:
//
// * installing/installing_aws/installing-aws-default.adoc
// * installing/installing_aws/installing-aws-customizations.adoc
// * installing-byoh/installing-existing-hosts.adoc

[id="installation-overview-{context}"]
= {product-title} installation overview

The {product-title} installation program offers you flexibility. You can use the installation
program to deploy a cluster on infrastructure that the installation program
provisions and the cluster maintains or deploy a cluster on infrastructure
that you prepare and maintain.

These two basic types of {product-title} clusters are
Installer Provisioned Infrastructure (IPI) clusters and
and User Provisioned Infrastructure (UPI) clusters.

You use the same installation program to deploy both types of clusters. The main
assets generated by the installation program are the Ignition config files for the
bootstrap, master, and worker machines. With these three configurations and correctly
configured infrastructure, you can start an {product-title} cluster.

[id="available-platforms-{context}"]
== Available platforms

In {product-title} {product-version}, you can complete UPI installations on the
following platforms:

* AWS
* Bare metal
////
* vSphere
////

[id="installation-process-{context}"]
== Installation process

When you install an {product-title} cluster, you download the
installer from link:https://cloud.openshift.com/clusters/install[the OpenShift start page].
This site manages:

* REST API for accounts
* Registry tokens, which are the pull secrets that you use to obtain the required
components
* Cluster registration, which associates the cluster identity to your Red Hat
account to facilitate the gathering of usage metrics

In {product-title} 4, the installation program is a Go binary file that performs a
series of file transformations on a set of assets. The way you interact with the
installation program differs depending on your installation type.

* When you use IPI, you delegate the infrastructure bootstrapping and provisioning
to the installation program
instead of doing it yourself. Because you do not use the installation program to upgrade or
update your cluster, if you do not customize your cluster, you run the
installer only once. If you customize your cluster, you run the installation
program to generate the required configuration files and then run it again to
deploy your cluster.

* When you use UPI, you must
provide all of the cluster infrastructure and resources, including the
bootstrap node. You must run the installation program to generate the required
configuration files and then run the installation program again to deploy a cluster
to your configured infrastructure.

You use three sets of files during installation: an installation configuration
file, Kubernetes manifests, and Ignition config files for your machine types.

[IMPORTANT]
====
It is possible to modify Kubernetes and the Ignition config files that control
the underlying {op-system-first} operating system during installation. However,
no validation is available to confirm the suitability of any modifications that
you make to these objects. If you modify these objects, you might render
your cluster non-functional. Because of this risk, modifying Kubernetes and
Ignition config files is not supported unless you are following documented procedures
or are instructed to do so by Red Hat support.
====

The installation configuration file is transformed into Kubernetes manifests, and
then the manifests are wrapped into Ignition config files. The installation program uses
these Ignition config files to create the cluster.

The installation configuration files are all pruned when you run the installation program,
so be sure to back up all configuration files that you want to use again.

[IMPORTANT]
====
You cannot modify the parameters that you set during installation, but you can
modify many cluster attributes after installation.
====

[discrete]
=== IPI cluster installation process

[IMPORTANT]
====
In version {product-version}, you can perform an
Installer Provisioned Infrastructure (IPI) install {product-title} on only
Amazon Web Services (AWS).
====

The default installation type is IPI on AWS. By default, the installation
program acts as an installation wizard, prompting you
for values that it cannot determine on its own and providing reasonable default
values for the remaining parameters. You can also customize the installation
process to support advanced infrastructure scenarios. The installation program provisions
the underlying infrastructure for the cluster.

You can install either a standard cluster or a customized cluster. With a
standard cluster, you provide minimum details that are required to install the
cluster. With a customized cluster, you can specify more details about the
platform, such as the number of machines that the control plane uses, the type
of virtual machine that the cluster deploys, or the CIDR range for the
Kubernetes service network.

If possible, use this feature to avoid
having to provision and maintain the cluster infrastructure. In all other
environments, you use the installation program to generate the assets that you require to
provision your cluster infrastructure.

With IPI clusters, {product-title} manages all aspects of
the cluster, including the operating system itself. Each machine boots with a
configuration that references resources hosted in the cluster that it joins.
This configuration allows the cluster to manage itself as updates are applied.

[discrete]
=== UPI cluster installation process

You can also install {product-title} on infrastructure that you provide. You use the
installation program to generate the assets that you require to provision the
cluster infrastructure, create the cluster infrastructure, and then deploy
the cluster to the infrastructure that you provided.

With UPI clusters, you must manage and maintain the cluster resources yourself,
including:

* The control plane and compute machines that make up the cluster
* Load balancers
* Cluster networking, including the DNS records and required subnets

[discrete]
=== Bootstrap process details

Because each machine in the cluster requires information about the cluster when
it is provisioned, {product-title} uses a temporary _bootstrap_ machine during
initial configuration. This machine provides the required information. It boots
by using an Ignition config file
that describes how to create the cluster. This temporary machine
is a temporary control plane that launches the rest of the cluster and then is
destroyed. Both UPI and IPI clusters use the bootstrap process to initialize the
cluster, but for UPI clusters, you must complete many of the steps manually.

Bootstrapping a cluster involves the following steps:

. The bootstrap machine boots and starts hosting the remote resources required
for the master machines to boot. (Requires manual intervention for UPI)
. The master machines fetch the remote resources from the bootstrap machine
and finish booting. (Requires manual intervention for UPI)
. The master machines use the bootstrap node to form an etcd cluster.
. The bootstrap node starts a temporary Kubernetes control plane using the
new etcd cluster.
. The temporary control plane schedules the production control plane to the
master machines.
. The temporary control plane shuts down and passes control to the production
control plane.
. The bootstrap node injects {product-title} components into the production
control plane.
. The installation program shuts down the bootstrap node.
(Requires manual intervention for UPI)

The result of this bootstrapping process is a fully running {product-title}
cluster. The cluster then downloads and configures remaining components
needed for the day-to-day operation, including the creation of worker machines
in supported environments.

[discrete]
== Installation scope

The scope of the {product-title} installation program is intentionally narrow.
It is designed for simplicity and ensured success. You can complete many
more configuration tasks after installation completes.